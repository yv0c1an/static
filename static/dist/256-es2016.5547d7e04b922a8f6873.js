(self.webpackChunkwlc_site=self.webpackChunkwlc_site||[]).push([[256],{55099:function(e,t,i){"use strict";i.d(t,{a:function(){return d}});var s=i(17161),r=i(84141),a=i(82560),o=i(56298),n=i(13594),l=i(91074),u=i(77360);class d extends s.z{constructor(e,t,i){super({from:(0,o.Z)({model:"UserInfo"},e)}),this.translate=t,this.eventService=i,this.separateLoyalty=!1,this.$loyaltyData={}}get lockExpiresAt(){var e;return null===(e=this.data)||void 0===e?void 0:e.LockExpiresAt}get affiliateID(){var e;return null===(e=this.data)||void 0===e?void 0:e.affiliateID}get availableWithdraw(){var e;return null===(e=this.data)||void 0===e?void 0:e.availableWithdraw}get balance(){var e;return null===(e=this.data)||void 0===e?void 0:e.balance}get category(){var e;return null===(e=this.data)||void 0===e?void 0:e.category}get email(){var e;return null===(e=this.data)||void 0===e?void 0:e.email}get emailHash(){var e;return null===(e=this.data)||void 0===e?void 0:e.emailHash}get firstName(){var e;return null===(e=this.data)||void 0===e?void 0:e.firstName}get freeRounds(){var e;return null===(e=this.data)||void 0===e?void 0:e.freerounds}get freespins(){return(0,r.Z)(this.freeRounds,(e,t)=>e+Number((0,a.Z)(t,"Count",0)),0)}get idUser(){var e;return null===(e=this.data)||void 0===e?void 0:e.idUser}get lastName(){var e;return null===(e=this.data)||void 0===e?void 0:e.lastName}get loyalty(){return this.$loyaltyData}set loyalty(e){var t,i;if(this.$loyaltyData=(0,o.Z)({},this.$loyaltyData,e),(0,n.Z)(null===(t=this.$loyaltyData)||void 0===t?void 0:t.LevelName))try{(0,o.Z)(this.$loyaltyData,{LevelName:JSON.parse(null===(i=this.$loyaltyData)||void 0===i?void 0:i.LevelName)})}catch(s){}this.data.loyalty=this.$loyaltyData,this.checkData()}get pinCode(){var e;return null===(e=this.data)||void 0===e?void 0:e.pincode}get socketsData(){var e;return null===(e=this.data)||void 0===e?void 0:e.socketsData}get status(){var e;return null===(e=this.data)||void 0===e?void 0:e.status}get bonusBalance(){var e,t,i,s;return(0,u.Z)(null===(t=null===(e=this.data)||void 0===e?void 0:e.loyalty)||void 0===t?void 0:t.BonusesBalance)?null:(0,r.Z)(null===(s=null===(i=this.data)||void 0===i?void 0:i.loyalty)||void 0===s?void 0:s.BonusesBalance,(e,t)=>e+Number((0,a.Z)(t,"Balance",0)),0)}get realBalance(){return this.balance-this.bonusBalance}get level(){var e,t;return+(null===(t=null===(e=this.data)||void 0===e?void 0:e.loyalty)||void 0===t?void 0:t.Level)||0}get levelName(){var e,t,i,s;const r=this.translate.currentLang;return(null===(t=null===(e=this.data)||void 0===e?void 0:e.loyalty)||void 0===t?void 0:t.LevelName[r])||(null===(s=null===(i=this.data)||void 0===i?void 0:i.loyalty)||void 0===s?void 0:s.LevelName.en)}get points(){var e,t;return+(null===(t=null===(e=this.data)||void 0===e?void 0:e.loyalty)||void 0===t?void 0:t.Points)||0}get nextLevelPoints(){var e,t;return+(null===(t=null===(e=this.data)||void 0===e?void 0:e.loyalty)||void 0===t?void 0:t.NextLevelPoints)||0}set data(e){var t;super.data=(0,l.Z)(e),this.data&&this.separateLoyalty?(this.$loyaltyData?this.data.loyalty=this.$loyaltyData:this.$loyaltyData=this.data.loyalty,this.data.loyalty&&(this.data.loyalty.BonusesBalance=e.loyalty.BonusesBalance)):this.$loyaltyData=null===(t=this.data)||void 0===t?void 0:t.loyalty}get data(){return super.data}checkData(){}}},12634:function(e,t,i){"use strict";i.d(t,{I:function(){return n}});var s=i(17161),r=i(56298),a=i(82560),o=i(20331);class n extends s.z{constructor(e){super({from:(0,r.Z)({model:"UserProfile"},e)}),this.init()}get address(){return this.data.address}get bankName(){return this.data.bankName}get bankNameText(){return this.data.bankNameText}get birthDay(){return this.data.birthDay}get birthMonth(){return this.data.birthMonth}get birthYear(){return this.data.birthYear}get branchCode(){return this.data.branchCode}get city(){return this.data.city}get countryCode(){return this.data.countryCode}get currency(){return this.data.currency||"EUR"}get email(){return this.data.email}get emailVerified(){return this.data.emailVerified}get emailAgree(){return this.data.emailAgree}get extProfile(){return this.data.extProfile||{}}get firstName(){return this.data.firstName}get gender(){return this.data.gender}get ibanNumber(){return this.data.ibanNumber}get idNumber(){return this.data.idNumber}get idUser(){return this.data.idUser}get lastName(){return this.data.lastName}get login(){return this.data.login}get newEmail(){return this.data.newEmail}get phoneAltCode(){return this.data.phoneAltCode}get phoneAltNumber(){return this.data.phoneAltNumber}get phoneCode(){return this.data.phoneCode}get phoneNumber(){return(0,o.Z)(this.data.phoneNumber)}get phoneVerified(){return this.data.phoneVerified}get postalCode(){return this.data.postalCode}get registrationBonus(){return this.data.registrationBonus}get swift(){return this.data.swift}get smsAgree(){return this.data.smsAgree}get VerificationJobID(){return this.data.VerificationJobID}get VerificationSessionID(){return this.data.VerificationSessionID}get birthDate(){return this.data.birthDate}get oddsStyle(){return this.data.oddsStyle}get socketData(){return this.data.socketsData}get pep(){return this.data.extProfile.pep}hasField(e){return!!(0,a.Z)(this.data,e)}fieldIsEmpty(e){return!(0,a.Z)(this.data,e)}init(){this.data={address:"",bankName:"",bankNameText:"",birthDay:"",birthMonth:"",birthYear:"",branchCode:"",city:"",countryCode:"",currency:"",email:"",emailVerified:"",extProfile:{},firstName:"",gender:"",ibanNumber:"",idNumber:"",idUser:"",lastName:"",login:"",newEmail:"",phoneAltCode:"",phoneAltNumber:"",phoneCode:"",phoneNumber:"",phoneVerified:"",postalCode:"",registrationBonus:"",swift:"",VerificationJobID:"",VerificationSessionID:"",birthDate:"",oddsStyle:""}}}},56256:function(e,t,i){"use strict";i.d(t,{y:function(){return s},K:function(){return I}});var s,r=i(64762),a=i(88720),o=i(5469),n=i(55429),l=i(99120),u=i(26215),d=i(45435),h=i(25884),c=i(26461),v=i(41589),g=i(67444),f=i(86892),m=i(86093),y=i(73180),S=i(12634),p=i(55099),R=i(46704),E=i(56298),P=i(29114),b=i(6641),U=i(17842);!function(e){e.ChangeLanguage="CHANGE_LANGUAGE"}(s||(s={}));let I=class{constructor(e,t,i,s,r,a,o,n){this.translate=e,this.dataService=t,this.eventService=i,this.configService=s,this.logService=r,this.modalService=a,this.injectionService=o,this.stateService=n,this.userProfile$=new u.X(null),this.userInfo$=new u.X(null),this.configUserProfile$=this.configService.get({name:"$user.userProfile$"}),this.configUserInfo$=this.configService.get({name:"$user.userInfo$"}),this.init()}get userInfo(){return this.info.dataReady?this.info:null}get userProfile(){var e;return(null===(e=this.profile)||void 0===e?void 0:e.dataReady)?this.profile:null}init(){this.isAuthenticated=this.configService.get("$user.isAuthenticated"),this.userProfile$.subscribe(e=>{this.configUserProfile$.next(e)}),this.userInfo$.subscribe(e=>{this.configUserInfo$.next(e)}),this.translate.onLangChange.subscribe(()=>(0,r.__awaiter)(this,void 0,void 0,function*(){this.isAuthenticated&&(yield this.updateLanguage(),this.eventService.emit({name:s.ChangeLanguage}))})),this.registerMethods(),this.info=new p.a({service:"UserService",method:"constructor"},this.translate,this.eventService),this.profile=new S.I({service:"UserService",method:"constructor"}),this.eventService.subscribe({name:"USER_INFO"},e=>{401!==(null==e?void 0:e.code)?(this.info.data=null==e?void 0:e.data,this.userInfo$.next(this.info),this.info.socketsData&&(this.info.separateLoyalty=!0,this.dataService.setSocketUrl(this.info.socketsData))):this.logout()}),this.eventService.subscribe([{name:"USER_PROFILE"}],e=>{this.profile.data=null==e?void 0:e.data,this.userProfile$.next(this.profile)}),this.eventService.subscribe({name:"SOCKET_CONNECT",status:"success"},()=>{this.dataService.socketRequest("loyalty.get")}),this.dataService.flow.pipe((0,d.h)(e=>"socket"===e.system&&("loyalty-get"===e.name||"loyalty-UserInfo"===e.name))).subscribe(e=>{this.info.loyalty=e.data,this.userInfo$.next(this.info),this.eventService.emit({name:"USER_INFO",data:this.info})}),this.eventService.subscribe([{name:"PROFILE_UPDATE"}],()=>{this.userProfile$.next(this.profile)}),this.eventService.subscribe({name:"LOGIN"},()=>{this.isAuthenticated=!0,this.configService.set({name:"$user.isAuthenticated",value:!0}),this.fetchUserProfile().then(()=>(0,r.__awaiter)(this,void 0,void 0,function*(){this.limitationService||(this.limitationService=yield this.injectionService.getService("user.limitation-service")),this.limitationService.initRealityChecker(this.userProfile$,!0),this.fetchUserInfo(),this.startUserInfoFetcher(),this.idleHandler()}))}),this.eventService.subscribe({name:"LOGOUT"},()=>{this.isAuthenticated=!1,this.configService.set({name:"$user.isAuthenticated",value:!1}),this.stateService.go("app.home",{locale:this.translate.currentLang}),this.dataService.closeSocket(),this.stopUserInfoFetcher(),this.info=new p.a({service:"UserService",method:"constructor"},this.translate,this.eventService),this.userInfo$.next(this.info),this.profile=new S.I({service:"UserService",method:"constructor"}),this.userProfile$.next(this.profile)}),this.eventService.subscribe({name:"USER_STATUS_DISABLE"},()=>{this.logout()}),this.isAuthenticated&&this.fetchUserProfile().then(()=>(0,r.__awaiter)(this,void 0,void 0,function*(){this.limitationService||(this.limitationService=yield this.injectionService.getService("user.limitation-service")),this.limitationService.initRealityChecker(this.userProfile$),this.fetchUserInfo(),this.startUserInfoFetcher(),this.idleHandler()}))}setProfileData(e){(0,P.Z)((0,b.Z)(e),t=>{this.profile.data[t]=e[t]}),this.userProfile$.next(this.profile)}validateRegistration(e){return this.dataService.request("user/userRegistration",e)}login(e,t){const i=this.dataService.request("user/userLogin",{login:e,password:t});return this.logService.sendLog({code:"1.2.5"}),i.catch(e=>{this.logService.sendRequestLog({coreLog:{code:"1.2.3"},networkLog:{code:"1.2.4"},from:{service:"UserService",method:"login"},responseData:e})}),i}logout(){this.dataService.request("user/userLogout")}createUserProfile(e){var t;this.configService.get("$base.profile.limitations.use")&&!(null===(t=e.extProfile)||void 0===t?void 0:t.realityCheckTime)&&(0,U.Z)(e,"extProfile.realityCheckTime",30),this.configService.get("$base.turnOnSendEmailNotificationInRegister")&&(e.emailAgree=!0);const i=this.dataService.request("user/createProfile",e);return this.logService.sendLog({code:"1.1.25"}),i.catch(e=>{this.logService.sendRequestLog({coreLog:{code:"1.1.23"},networkLog:{code:"1.1.24"},from:{service:"UserService",method:"createUserProfile"},responseData:e})}),i}registrationComplete(e){return this.dataService.request("user/registrationComplete",{code:e})}updateProfile(e,t=!1,i){var s;return(0,r.__awaiter)(this,void 0,void 0,function*(){const r=t?(0,E.Z)({},e,i?{isAfterDepositWithdraw:i}:{}):(0,E.Z)({},this.profile.data,e);if(["birthYear","birthDay","birthMonth"].every(t=>t in e)&&!this.checkUserAge(e)){let e=this.translate.instant(gettext("You are under the age of"));return e+=" "+this.configService.get("$base.profile.legalAge"),e+=this.translate.instant(gettext("age_end")),{errors:[e]}}try{const i=yield this.dataService.request({name:"updateProfile",system:"user",url:"/profiles",type:t?"PATCH":"PUT",events:{success:"PROFILE_UPDATE",fail:"PROFILE_UPDATE_ERROR"}},r);return(null===(s=i.data)||void 0===s?void 0:s.result)?((0,E.Z)(this.profile.data,e),this.userProfile$.next(this.userProfile),!0):i}catch(a){return a}})}sendPasswordRestore(e,t){const i={email:e};return t&&(i.reCaptchaToken=t),this.dataService.request("user/passwordRestore",i)}restoreNewPassword(e,t,i){const s={newPassword:e,repeatPassword:t,code:i};return this.dataService.request("user/restoreNewPassword",s)}validateRestoreCode(e=""){const t={action:"checkRestoreCode",code:e};return this.dataService.request("user/validateRestoreCode",t)}setNewPassword(e,t){const i={password:e,newPassword:t};return this.dataService.request("user/newPassword",i)}changePhone(e,t){const i={phoneCode:e,phoneNumber:t};this.dataService.request("user/updatePhone",i)}phoneUnique(e,t){const i={phone:e,code:t};this.dataService.request("user/phoneUnique",i)}changeEmail(e,t,i){const s={email:e};t&&(s.currentPassword=t),i&&(s.code=i),this.dataService.request("user/updateEmail",s)}emailUnique(e){return this.dataService.request("user/emailUnique",{email:e})}loginUnique(e){this.dataService.request("user/loginUnique",{login:e})}updateLogin(e){this.dataService.request("user/updateLogin",{login:e})}updateLanguage(){return(0,r.__awaiter)(this,void 0,void 0,function*(){return this.dataService.request("user/updateLanguage")})}disableProfile(){this.dataService.request("user/disableProfile")}fetchUserProfile(){return this.dataService.request("user/userProfile")}loginRequest(e,t){return(0,r.__awaiter)(this,void 0,void 0,function*(){try{yield this.login(e,t),this.modalService.hideModal("login")}catch(i){this.eventService.emit({name:m.LA.PushMessage,data:{type:"error",title:gettext("Login error"),message:i.errors,wlcElement:"notification_login-error"}})}})}finishRegistration(){const e=this.configService.get("appConfig.siteconfig.fastRegistration"),t=this.configService.get("appConfig.hideEmailExistence"),i=[gettext("Your account has been registered.")];e?(this.eventService.emit({name:"LOGIN"}),t||setTimeout(()=>{this.registrationRedirect()})):this.configService.get("appConfig.hideEmailExistence")?i.push(gettext("An email was sent to the specified email address. If you already have an account, we will send you a password recovery link. Kindly check your email box and confirm registration using the link in the email.")):i.push(gettext("Please complete registration using link in e-mail")),t&&e?this.eventService.filter([{name:"USER_PROFILE"},{name:"USER_PROFILE_ERROR"}]).pipe((0,h.P)()).subscribe({next:e=>{401===e.data.code?(this.logout(),this.failedRegistration()):(this.successfulRegistration(i),this.registrationRedirect())}}):this.successfulRegistration(i),this.modalService.getActiveModal("signup")&&this.modalService.hideModal("signup")}registrationRedirect(){const e=this.configService.get("$base.redirects.registration");e&&this.stateService.go(e.state,e.params||{})}checkUserAge({birthDay:e,birthYear:t,birthMonth:i}){const s=this.configService.get("$base.profile.legalAge");return-1*n.ou.utc(+t,+i,+e).diffNow("years").years>=s}successfulRegistration(e){this.eventService.emit({name:m.LA.PushMessage,data:{type:"success",title:gettext("Registration success"),message:e,wlcElement:"notification_registration-success"}})}failedRegistration(){this.modalService.showModal({id:"registration-errors",modalTitle:gettext("Sorry, something went wrong!"),modalMessage:gettext("Something went wrong during registration, check your email to change your password."),textAlign:"center",dismissAll:!0})}fetchUserInfo(){return(0,r.__awaiter)(this,void 0,void 0,function*(){try{yield this.dataService.request("user/userInfo")}catch(e){}})}startUserInfoFetcher(){this.userInfoHandler=this.dataService.subscribe("user/userInfo",e=>{if(e)try{this.eventService.emit({name:"USER_INFO",data:e})}catch(t){this.eventService.emit({name:"USER_INFO_ERROR",data:t})}})}stopUserInfoFetcher(){var e;null===(e=this.userInfoHandler)||void 0===e||e.unsubscribe(),this.dataService.reset("user/userInfo")}registerMethods(){this.dataService.registerMethod({name:"userRegistration",url:"/validate/user-register",type:"POST",system:"user",events:{success:"REGISTRATION",fail:"REGISTRATION_ERROR"}}),this.dataService.registerMethod({name:"userLogin",system:"user",url:"/auth",type:"PUT",events:{success:"LOGIN",fail:"LOGIN_ERROR"}}),this.dataService.registerMethod({name:"userLogout",system:"user",url:"/auth",type:"DELETE",events:{success:"LOGOUT",fail:"LOGOUT_ERROR"}}),this.dataService.registerMethod({name:"createProfile",system:"user",url:"/profiles",type:"POST",events:{success:"PROFILE_CREATE",fail:"PROFILE_CREATE_ERROR"}}),this.dataService.registerMethod({name:"registrationComplete",system:"user",url:"/profiles",type:"PATCH",events:{success:"REGISTER",fail:"REGISTER_ERROR"}}),this.dataService.registerMethod({name:"passwordRestore",system:"user",url:"/userPassword",type:"POST",events:{success:"PROFILE_RESTORE",fail:"PROFILE_RESTORE_ERROR"}}),this.dataService.registerMethod({name:"restoreNewPassword",system:"user",url:"/userPassword",type:"PUT",events:{success:"PROFILE_PASSWORD",fail:"PROFILE_PASSWORD_ERROR"}}),this.dataService.registerMethod({name:"validateRestoreCode",system:"user",url:"/userPassword",type:"GET",events:{success:"VALIDATE_RESTORE_CODE",fail:"VALIDATE_RESTORE_CODE_ERROR"}}),this.dataService.registerMethod({name:"newPassword",system:"user",url:"/userPassword",type:"PATCH",events:{success:"NEW_PASSWORD",fail:"NEW_PASSWORD_ERROR"}}),this.dataService.registerMethod({name:"updatePhone",system:"user",url:"/profiles/phone",type:"POST",events:{success:"UPDATE_PHONE",fail:"UPDATE_PHONE_ERROR"}}),this.dataService.registerMethod({name:"phoneUnique",system:"user",url:"/profiles/phone",type:"PUT",events:{success:"PHONE_UNIQUE",fail:"PHONE_UNIQUE_ERROR"}}),this.dataService.registerMethod({name:"updateEmail",system:"user",url:"/profiles/email",type:"POST",events:{success:"UPDATE_EMAIL",fail:"UPDATE_EMAIL_ERROR"}}),this.dataService.registerMethod({name:"emailUnique",system:"user",url:"/profiles/email",type:"PUT",events:{success:"EMAIL_UNIQUE",fail:"EMAIL_UNIQUE_ERROR"}}),this.dataService.registerMethod({name:"loginUnique",system:"user",url:"/profiles/login",type:"PUT",events:{success:"LOGIN_UNIQUE",fail:"LOGIN_UNIQUE_ERROR"}}),this.dataService.registerMethod({name:"updateLogin",system:"user",url:"/profiles/login",type:"POST",events:{success:"LOGIN_UPDATE",fail:"LOGIN_UPDATE_ERROR"}}),this.dataService.registerMethod({name:"updateLanguage",system:"user",url:"/profiles/language",type:"PATCH",events:{success:"LANGUAGE_UPDATE",fail:"LANGUAGE_UPDATE_ERROR"}}),this.dataService.registerMethod({name:"disableProfile",system:"user",url:"/profiles/disable",type:"PUT",events:{success:"DISABLE_PROFILE",fail:"DISABLE_PROFILE_ERROR"}}),this.dataService.registerMethod({name:"userProfile",system:"user",url:"/profiles",type:"GET",events:{success:"USER_PROFILE",fail:"USER_PROFILE_ERROR"}}),this.dataService.registerMethod({name:"userInfo",system:"user",url:"/userInfo",type:"GET",period:1e4})}idleHandler(){return(0,r.__awaiter)(this,void 0,void 0,function*(){this.configService.get('$modules.core.components["wlc-license"].mga')&&(this.idleService||(this.idleService=yield this.injectionService.getService("user.idle-service")),this.idleService.init())})}};I.ctorParameters=()=>[{type:o.sK},{type:y.D},{type:g.P},{type:v.E4},{type:c.$},{type:f.Z},{type:R.Y},{type:l.StateService}],I=(0,r.__decorate)([(0,a.GSi)({providedIn:"root"})],I)}}]);